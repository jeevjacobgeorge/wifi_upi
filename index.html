<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Connect WiFi and Pay UPI</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 50px;
      padding: 0 10px;
    }
    h1 {
      color: #333;
    }
    p {
      font-size: 16px;
      color: #555;
    }
    .btn {
      padding: 15px 25px;
      font-size: 18px;
      margin: 10px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
      color: #fff;
    }
    #wifiButton {
      background-color: #007bff;
    }
    #upiButton {
      background-color: #28a745;
    }
  </style>
</head>
<body>
  <h1>Welcome!</h1>
  <p>Scan the QR code to auto-fill WiFi and UPI details.</p>
  <div>
    <button id="wifiButton" class="btn">Connect WiFi</button>
    <button id="upiButton" class="btn">Pay UPI</button>
  </div>

  <script>
    // Get query parameters from URL
    const params = new URLSearchParams(window.location.search);
    const ssid = params.get('ssid') || '';
    const password = params.get('password') || '';
    const encryption = params.get('encryption') || 'WPA'; // default to WPA

    const upi_id = params.get('upi_id') || '';
    const upi_name = params.get('upi_name') || '';
    const upi_amount = params.get('upi_amount') || '';
    const upi_note = params.get('upi_note') || '';

    // Build UPI deep link URL
    const upiUrl = `upi://pay?pa=${encodeURIComponent(upi_id)}&pn=${encodeURIComponent(upi_name)}`
                 + (upi_amount ? `&am=${encodeURIComponent(upi_amount)}` : '')
                 + (upi_note ? `&tn=${encodeURIComponent(upi_note)}` : '')
                 + `&cu=INR`;

    // Set UPI button action: when clicked, redirect to the UPI link
    const upiButton = document.getElementById('upiButton');
    upiButton.onclick = function() {
      window.location.href = upiUrl;
    };

    // For WiFi, try to create an Android intent URL.
    // Note: Auto-connecting to WiFi is not standardized.
    // Some Android devices might support an intent URL that opens WiFi settings.
    const wifiButton = document.getElementById('wifiButton');
    // Construct an intent URL with SSID and password (this is experimental)
    const wifiIntentUrl = `intent://connect/wifi?ssid=${encodeURIComponent(ssid)}&password=${encodeURIComponent(password)}`
                        + `#Intent;scheme=wifi;package=com.android.settings;end`;

    wifiButton.onclick = function() {
      // Attempt to open the intent URL (works on some Android devices)
      window.location.href = wifiIntentUrl;
    };

    /* Alternative approach:
       If you prefer to copy WiFi details to the clipboard instead of using an intent URL,
       uncomment the code below and comment out the wifiButton.onclick above.

    wifiButton.onclick = async function() {
      const wifiConfig = `SSID: ${ssid}\nPassword: ${password}\nEncryption: ${encryption}`;
      try {
        await navigator.clipboard.writeText(wifiConfig);
        alert("WiFi credentials copied to clipboard. Please open your WiFi settings and connect.");
      } catch (err) {
        alert("Failed to copy WiFi credentials. Please note them manually:\n" + wifiConfig);
      }
    };
    */
  </script>
</body>
</html>
